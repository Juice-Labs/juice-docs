"use strict";(self.webpackChunkjuice_docs=self.webpackChunkjuice_docs||[]).push([[4420],{1770:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>d,frontMatter:()=>c,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"juice/pro-users/running-applications/docker","title":"Docker","description":"You can run the Juice client within a Docker container to leverage remote GPUs managed by juice without installing the entire agent on your host machine.","source":"@site/docs/juice/pro-users/running-applications/docker.md","sourceDirName":"juice/pro-users/running-applications","slug":"/juice/pro-users/running-applications/docker","permalink":"/juice-docs/docs/juice/pro-users/running-applications/docker","draft":false,"unlisted":false,"editUrl":"https://github.com/juice-labs/juice-docs/edit/master/docs/juice/pro-users/running-applications/docker.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"title":"Docker","sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Troubleshooting","permalink":"/juice-docs/docs/juice/pro-users/cli-app/troubleshooting"},"next":{"title":"Jupyterlab","permalink":"/juice-docs/docs/juice/pro-users/running-applications/jupyterlab"}}');var r=i(4848),o=i(8453);const c={title:"Docker",sidebar_position:1},s="Docker",a={},l=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"To use juice in Docker:",id:"to-use-juice-in-docker",level:3},{value:"Example",id:"example",level:4},{value:"Example",id:"example-1",level:4}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"docker",children:"Docker"})}),"\n",(0,r.jsx)(n.p,{children:"You can run the Juice client within a Docker container to leverage remote GPUs managed by juice without installing the entire agent on your host machine."}),"\n",(0,r.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Docker"}),": Ensure you have Docker installed and running on your system."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Active Account"}),": You'll need an active Juice account and access to a pool with available GPUs."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"M2M Token"}),": Generate an M2M token from your juice account to enable automated login within the container. See the ",(0,r.jsx)(n.a,{href:"/juice-docs/docs/juice/pro-users/cli-app/m2m-tokens",children:"Machine-to-Machine (M2M) Tokens"})," section of the Juice (Pro) User Guide for instructions."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Juice Tarball"}),": Download the latest juice Linux tarball from juicelabs.co."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"to-use-juice-in-docker",children:"To use juice in Docker:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a file [Dockerfile] in your working directory."}),"\n",(0,r.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# Use Ubuntu 24.04 as the base image \n\nFROM ubuntu:24.04 \n\n\n\n# Install necessary packages \n\nRUN apt-get update && \\ \n\n    apt-get upgrade -y && \\ \n\n    DEBIAN_FRONTEND=noninteractive apt-get install -y \\ \n\n    ca-certificates \\ \n\n    libnuma1 \\ \n\n    libatomic1 && \\ \n\n    rm -rf /var/lib/apt/lists/* \n\n\n\n# Set working directory inside the container \n\nWORKDIR /root \n\n\n\n# Copy the juice tarball and the run script \n\nCOPY juice-linux.tar.gz . \n\nCOPY --chown=ubuntu:ubuntu --chmod=777 run.sh . \n\n\n\n# Convert run.sh to Unix line endings \n\nRUN sed -i \'s/\\r//\' run.sh \n\n\n\n# Verify the integrity of the juice tarball \n\nRUN echo "a08df200b8b78f54c37f9e330ee9a5537865f57efa168af7980bb8ade3d26e97 juice-linux.tar.gz" | sha256sum -c - && \\ \n\n    tar -xvf juice-linux.tar.gz  \n\n\n\n# Define the entry point for the container \n\nENTRYPOINT ["/bin/bash", "-c", "/root/run.sh ${@}", "--"] \n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Create a file named run.sh in the same directory as your [Dockerfile] with the following contents:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'#!/bin/bash \n\n\n\n# Check if at least one argument is provided (M2M token) \n\nif [ $# -eq 0 ]; then \n\n   echo "Usage: $0 <m2m_token> [run_args...]" \n\n   exit 1 \n\nfi \n\n\n\n# The first argument is the M2M token \n\nm2m_token="$1" \n\n\n\n# Shift the arguments to remove the M2M token \n\nshift \n\n\n\n# Log in to juice using the M2M token \n\n./juice login --token "$m2m_token" \n\n\n\n# Execute the juice run command with the remaining arguments \n\n./juice run "$@" \n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Open a terminal, navigate to the directory containing your [Dockerfile], run.sh, and execute the following command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"docker build -t juice-client . \n"})}),"\n",(0,r.jsx)(n.admonition,{type:"note",children:(0,r.jsx)(n.p,{children:"This command builds a Docker image named juiceclient using the instructions in your [Dockerfile]."})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsx)(n.p,{children:"Once the image is built, you can run a container using your M2M token and desired juice run arguments:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"docker run -it juice-client <your_m2m_token> <juice_run_args>\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"Replace <your_m2m_token> with your actual M2M token. Replace <juice_run_args> with the desired arguments for the juice run command (i.e. --pool-ids, --gpu-ids, etc.)."})}),"\n",(0,r.jsx)(n.h4,{id:"example-1",children:"Example"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"docker run -it juice-client m2m_e6q_87LwpLY1dwh4FpX --pool-ids <your_pool_id> bash  \n\n\n# This command launches an interactive container, logs in using your M2M token, and executes the bash command inside the container. You can replace bash with any other juice command or application you want to run remotely. \n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Applications and commands executed within the container utilize the remote GPU resources provided by juice. Refer to the [juice User Guide] for detailed information about available commands, options, and troubleshooting."})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>c,x:()=>s});var t=i(6540);const r={},o=t.createContext(r);function c(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);